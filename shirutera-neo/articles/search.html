<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>æ¤œç´¢çµæœ - Shirutera</title>
  <link rel="stylesheet" href="assets/css/main.css" />
</head>
<body class="is-preload">

  <!-- Headerãªã©ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ã‹ã‚‰å…±é€šéƒ¨åˆ†ã‚’æµç”¨ -->

  <!-- Main -->
  <div id="main" class="wrapper">
    <div class="inner">
      <h1>ğŸ” æ¤œç´¢çµæœ</h1>
      <p id="query-label"></p>
      <ul id="search-result" class="mini-posts"></ul>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const params = new URLSearchParams(window.location.search);
      const query = params.get("q");
      const label = document.getElementById("query-label");
      const list = document.getElementById("search-result");

      if (!query) {
        label.textContent = "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚";
        return;
      }

      label.textContent = `ã€Œ${query}ã€ã®æ¤œç´¢çµæœã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚`;

      const url = `https://script.google.com/macros/s/AKfycbx6Xc-q55Ui8yfP34Il3APnEzQQwwjVRTMzYNwRCw_mX2MveXs0jIJJPWx7ZMv8UTocrg/exec?mode=search&query=${encodeURIComponent(query)}`;

      try {
        const res = await fetch(url);
        const data = await res.json();

        if (data.length === 0) {
          list.innerHTML = "<li>è©²å½“ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</li>";
          return;
        }

        data.forEach(item => {
          const li = document.createElement("li");
          const article = document.createElement("article");

          const h3 = document.createElement("h3");
          h3.textContent = item.ã‚¿ã‚¤ãƒˆãƒ« || "ï¼ˆç„¡é¡Œï¼‰";

          const p = document.createElement("p");
          p.textContent = item.è¦ç´„ || "";

          const a = document.createElement("a");
          a.href = item.URL || "#";
          a.className = "button";
          a.target = "_blank";
          a.textContent = "ç¶šãã‚’èª­ã‚€";

          article.appendChild(h3);
          article.appendChild(p);
          article.appendChild(a);
          li.appendChild(article);
          list.appendChild(li);
        });

      } catch (err) {
        console.error("æ¤œç´¢ã‚¨ãƒ©ãƒ¼:", err);
        list.innerHTML = "<li>æ¤œç´¢ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</li>";
      }
    });
  </script>

  <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ã®JSèª­ã¿è¾¼ã¿ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰ -->
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/browser.min.js"></script>
  <script src="assets/js/breakpoints.min.js"></script>
  <script src="assets/js/util.js"></script>
  <script src="assets/js/main.js"></script>
</body>
</html>
